<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        #log {
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div id="log">Starting...</div>
    <button onclick="checkPermissions()">Check Permissions</button>
    <button onclick="requestPermissions()">Request Permissions</button>
    <script>
        const log = document.getElementById('log');
        
        function addLog(msg) {
            log.textContent += '\n' + msg;
            console.log(msg);
        }

        async function checkPermissions() {
            try {
                addLog('Checking camera permission...');
                const result = await navigator.permissions.query({ name: 'camera' });
                addLog('Permission state: ' + result.state);
            } catch(e) {
                addLog('Check error: ' + e.message);
            }
        }

        async function requestPermissions() {
            try {
                addLog('Requesting camera...');
                const devices = await navigator.mediaDevices.enumerateDevices();
                addLog('Devices found: ' + devices.length);
                devices.forEach(d => addLog(d.kind + ': ' + d.label));
            } catch(e) {
                addLog('Request error: ' + e.message);
            }
        }

        // Log initial state
        addLog('Page loaded');
        if (navigator.mediaDevices) {
            addLog('mediaDevices available');
        } else {
            addLog('NO mediaDevices!');
        }
    </script>
</body>
</html>